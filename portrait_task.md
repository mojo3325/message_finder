# –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–Ω–æ–ø–∫–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç–∞ üë®üèª‚Äçü¶∞

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É üë®üèª‚Äçü¶∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ" –≤–º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ä–µ—Ç–∞.

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞**: –ú–æ–¥—É–ª—å `portrait` –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑-–∑–∞ –ø—É—Å—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ `tg/handlers/__init__.py`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `portrait.handle_callback()` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å callback —Å –¥–µ–π—Å—Ç–≤–∏–µ–º `portrait`.

### –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
1. **–ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ**: –í `tg/ui.py` –∫–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å `callback_data: f"portrait:{sid}"` (—Å—Ç—Ä–æ–∫–∏ 38 –∏ 261)
2. **–ü–∞—Ä—Å–∏–Ω–≥ callback_data —Ä–∞–±–æ—Ç–∞–µ—Ç**: –í `tg/bot_poller.py` —Å—Ç—Ä–æ–∫–∞ 98 –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–∞—Ä—Å–∏—Ç `action, sid = data_s.split(":", 1)`
3. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**: –§–∞–π–ª `tg/handlers/portrait.py` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `handle_callback()`
4. **–ò–º–ø–æ—Ä—Ç –∑–∞—è–≤–ª–µ–Ω**: –í `tg/bot_poller.py` —Å—Ç—Ä–æ–∫–∞ 12 –µ—Å—Ç—å –∏–º–ø–æ—Ä—Ç `from tg.handlers import account_flow, warp, portrait`
5. **–ù–û**: –§–∞–π–ª `tg/handlers/__init__.py` –ø—É—Å—Ç–æ–π, –ø–æ—ç—Ç–æ–º—É –º–æ–¥—É–ª—å `portrait` –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É üë®üèª‚Äçü¶∞
2. Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç callback —Å `data="portrait:{sid}"`
3. `bot_poller.py` –ø–∞—Ä—Å–∏—Ç callback: `action="portrait"`, `sid="{sid}"`
4. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `portrait.handle_callback()` - –Ω–æ –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑-–∑–∞ –ø—É—Å—Ç–æ–≥–æ `__init__.py`
5. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `False` (–Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω)
6. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è fallback: `bot_answer_callback_query(cb_id, text="–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ")`

## –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### TODO: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª—è portrait

#### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª `tg/handlers/__init__.py`
- **–ó–∞–¥–∞—á–∞**: –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –º–æ–¥—É–ª—è `portrait` –≤ `__init__.py`
- **–î–µ–π—Å—Ç–≤–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É `from . import portrait` –≤ —Ñ–∞–π–ª `__init__.py`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
- **–í—Ä–µ–º—è**: 2 –º–∏–Ω—É—Ç—ã

#### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- **–ó–∞–¥–∞—á–∞**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `account_flow` –∏ `warp` —Ç–æ–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
- **–î–µ–π—Å—Ç–≤–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –¥–ª—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ `__init__.py`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í—ã—Å–æ–∫–∏–π
- **–í—Ä–µ–º—è**: 3 –º–∏–Ω—É—Ç—ã

#### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ó–∞–¥–∞—á–∞**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∫–Ω–æ–ø–∫–∏ –ø–æ—Ä—Ç—Ä–µ—Ç–∞
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É üë®üèª‚Äçü¶∞
- **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ–ª–∂–Ω–∞ –Ω–∞—á–∞—Ç—å—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç—Ä–µ—Ç–∞ –≤–º–µ—Å—Ç–æ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ"
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í—ã—Å–æ–∫–∏–π
- **–í—Ä–µ–º—è**: 5 –º–∏–Ω—É—Ç

#### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
- **–ó–∞–¥–∞—á–∞**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ –≤ –ª–æ–≥–∞—Ö
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞
- **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –°—Ä–µ–¥–Ω–∏–π
- **–í—Ä–µ–º—è**: 2 –º–∏–Ω—É—Ç—ã

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

#### 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–ó–∞–¥–∞—á–∞**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è `portrait.py` –¥–æ—Å—Ç—É–ø–Ω—ã
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤ `services/portrait.py` –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –°—Ä–µ–¥–Ω–∏–π
- **–í—Ä–µ–º—è**: 3 –º–∏–Ω—É—Ç—ã

#### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- **–ó–∞–¥–∞—á–∞**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å try-catch –±–ª–æ–∫–∏ –≤ `portrait.py`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ù–∏–∑–∫–∏–π
- **–í—Ä–µ–º—è**: 2 –º–∏–Ω—É—Ç—ã

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ –ö–Ω–æ–ø–∫–∞ üë®üèª‚Äçü¶∞ –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è
2. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç "–°–æ–±–∏—Ä–∞—é —Å–æ–æ–±—â–µ–Ω–∏—è‚Ä¶" –≤–º–µ—Å—Ç–æ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ"
3. ‚úÖ –ù–∞—á–Ω–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Ä—Ç—Ä–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. ‚úÖ –ë—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –ø–æ—Ä—Ç—Ä–µ—Ç–æ–º —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π

## –í—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: ~15 –º–∏–Ω—É—Ç
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å**: 2 –º–∏–Ω—É—Ç—ã (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `__init__.py`)
- **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: 10 –º–∏–Ω—É—Ç

## –†–∏—Å–∫–∏
- **–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∏–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π
- **–û—Ç–∫–∞—Ç**: –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `__init__.py`
- **–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, —Ç–æ–ª—å–∫–æ —É–ª—É—á—à–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
